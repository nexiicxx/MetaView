<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Player List</title>
    <link rel="stylesheet" href="../styles/variables.css">
    <link rel="stylesheet" href="../styles/index.css">
    <link rel="stylesheet" href="../styles/player-card.css">
</head>
<body>
    <div class="container">
        <div class="tab-navigation">
            <div class="tab-buttons">
                <button class="tab-button active" data-view="active-players">Active Players</button>
                <button class="tab-button" data-view="saved-players">Saved Players</button>
            </div>
            <a href="settings.html" class="settings-button">
                <svg class="settings-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
            </a>
        </div>

        <div class="view-container active" id="active-players">
            <div class="team-section ct-section">
                <div class="team-header">
                    <h2 class="ct-header">Counter-Terrorists</h2>
                </div>
                <div class="player-list" id="ct-list"></div>
            </div>

            <div class="team-section t-section">
                <div class="team-header">
                    <h2 class="t-header">Terrorists</h2>
                </div>
                <div class="player-list" id="t-list"></div>
            </div>
        </div>

        <div class="view-container" id="saved-players">
            <div class="team-section">
                <div class="team-header">
                    <h2>Saved Players</h2>
                </div>
                <div class="player-list" id="saved-list"></div>
            </div>
        </div>
    </div>

    <script type="module">
        import { PlayerList } from '../components/PlayerList.js';
        const configManager = require('../utils/config');

        // Initialize player lists
        const ctPlayers = new PlayerList('ct-list', 'ct');
        const tPlayers = new PlayerList('t-list', 't');
        const savedPlayers = new PlayerList('saved-list', 'saved');

        // Load saved players from config
        const loadSavedPlayers = () => {
            const savedPlayersList = configManager.loadSavedPlayers();
            savedPlayers.clearPlayers();
            savedPlayersList.forEach(player => {
                savedPlayers.addPlayer(player.name, player.steamid64);
            });
            savedPlayers.render();
        };

        // Initial load of saved players
        loadSavedPlayers();

        // Listen for save/unsave events
        window.addEventListener('playerSaved', (event) => {
            loadSavedPlayers();
        });

        window.addEventListener('playerUnsaved', (event) => {
            loadSavedPlayers();
        });

        // Handle tab navigation
        const tabs = document.querySelectorAll('.tab-button');
        const views = document.querySelectorAll('.view-container');

        function switchTab(targetId) {
            const targetView = document.getElementById(targetId);
            
            // Update tab buttons
            tabs.forEach(tab => {
                tab.classList.toggle('active', tab.dataset.view === targetId);
            });

            // Update view containers
            views.forEach(view => {
                if (view === targetView) {
                    view.classList.add('active');
                    view.style.opacity = '1';
                    view.style.transform = 'translateY(0)';
                } else {
                    view.classList.remove('active');
                    view.style.opacity = '0';
                    view.style.transform = 'translateY(-10px)';
                }
            });

            // Save current tab to localStorage
            localStorage.setItem('activeTab', targetId);

            // If switching to saved players, refresh the list
            if (targetId === 'saved-players') {
                loadSavedPlayers();
            }
        }

        // Add click handlers to tabs
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const targetView = tab.dataset.view;
                switchTab(targetView);
            });
        });

        // Restore last active tab
        const lastActiveTab = localStorage.getItem('activeTab') || 'active-players';
        switchTab(lastActiveTab);

        // Clean up when window unloads
        window.addEventListener('unload', () => {
            ctPlayers.destroy();
            tPlayers.destroy();
            savedPlayers.destroy();
        });
    </script>
</body>
</html> 